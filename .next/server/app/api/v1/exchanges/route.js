"use strict";(()=>{var e={};e.id=6170,e.ids=[6170],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},38548:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{GET:()=>p});var a=t(49303),i=t(88716),s=t(60670),o=t(87070),u=t(72331),c=t(53696);async function p(e){try{let r=await (0,c.H)(e);if(r.error)return o.NextResponse.json({error:r.error},{status:r.status});let t=r.customer?.id;if(!t)return o.NextResponse.json({error:"Customer ID not found"},{status:400});let n=await u._.exchange.findMany({where:{customerId:parseInt(t)},orderBy:{createdAt:"desc"}});return o.NextResponse.json(n)}catch(e){return o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/v1/exchanges/route",pathname:"/api/v1/exchanges",filename:"route",bundlePath:"app/api/v1/exchanges/route"},resolvedPagePath:"C:\\Users\\sainyi\\Desktop\\projects\\others\\trading-admin\\app\\api\\v1\\exchanges\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:x}=d,v="/api/v1/exchanges/route";function f(){return(0,s.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},90455:(e,r,t)=>{t.d(r,{Og:()=>c,Rp:()=>s,Ym:()=>o,so:()=>i});var n=t(24295),a=t(72331);function i(e){let r=e.headers.get("authorization");return r?.startsWith("Bearer ")?r.split(" ")[1]:null}async function s(e){try{if(await u(e))return null;let r=(0,n.WX)(e);return{id:r.customerId,email:r.email}}catch(e){return null}}async function o(e){let r=i(e);return r?s(r):null}async function u(e){let r=await a._.invalidtoken.findUnique({where:{token:e}});return!!r&&(!(r.expiresAt<new Date)||(await a._.invalidtoken.delete({where:{id:r.id}}),!1))}async function c(e,r){await a._.invalidtoken.create({data:{token:e,expiresAt:r}})}},24295:(e,r,t)=>{t.d(r,{RA:()=>s,WX:()=>o});var n=t(41482),a=t.n(n);let i=process.env.JWT_SECRET||"your-secret-key",s=e=>a().sign(e,i,{expiresIn:"30d"}),o=e=>{try{return a().verify(e,i)}catch(e){throw Error("Invalid token")}}},72331:(e,r,t)=>{t.d(r,{_:()=>a});var n=t(53524);let a=global.prisma||new n.PrismaClient({log:["query"]})},53696:(e,r,t)=>{t.d(r,{H:()=>a});var n=t(90455);async function a(e){try{let r=(0,n.so)(e);if(!r)return{error:"Authentication required",status:401};let t=await (0,n.Rp)(r);if(!t)return{error:"Invalid or expired token",status:401};return{customer:t,status:200}}catch(e){return console.error("Error in authentication:",e),{error:"Authentication failed",status:500}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,5972,1482],()=>t(38548));module.exports=n})();